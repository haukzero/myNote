# Vim Note

## Vim的三种模式

- Command mode : 执行各种命令来编辑文件
- Insert mode : 输入各种指令
- Normal mode : 与其他代码编辑器一样

## 不同模式的转换

- 退出Normal mode：`ESC`键
  - 一般将`Esc`键改为`jj`

- 进入Normal mode：
   ```
    i : input
    a : append
    o : open new line
   ```
  
  - `i`   ：光标跳到宽光标选中字符的左边
  
  - `a`   ：光标跳到宽光标选中字符的右边
  
  - `I`   ：光标跳到所在行的最左边
  
  - `A`   ：光标跳到所在行的最右边
  
  - `o`   ：在该行下方开启新的一行并跳到其开头
  
  - `O`   ：在该行上方开启新的一行并跳到其开头
  

## 光标移动

- 向上：`k`	(助记：***k*** ick up)
- 向下：`j`     (助记：***j*** ump down)
- 向左：`h`    (助记：***h*** ome)
- 向右：`l`     (助记：not ***l*** eft)
- 跳到下一个单词开头：`w`		(助记：***w*** ord)
- 跳到上一个单词开头：`b`		(助记：***b*** egin)
- 跳到字符串首：`B`
- 跳到下一个单词最后：`e`        (助记：***e*** nd)
- 跳到当前行开头：`^`或`0`
- 跳到当前行行尾：`$`
- 向上翻页：`ctrl + u`   (助记：page ***u*** p)
- 向下翻页：`ctrl + d`   (助记：page ***d*** own)
- 向右查找最近的目标字符：`f + <want>`   (助记：***f*** ind)c

## 删除、撤销与替换

- 删除单个字符：`x`	(删除宽光标所选中的字符)

- 可选删除：`d`   (需要配合其他键使用，类似 `y` )

  - 格式：`[number] d object`  或者`d [number] object`
    - `number`代表执行命令次数(可选项，缺省设为`1`)
    - `object`常用列表：
      - `w`：从当前光标当前位置直到单字/单词末尾，包括空格
      - `e`：从当前光标当前位置直到单字/单词末尾，但是 ***不包括*** 空格
      - `$`：从当前光标当前位置直到当前行末
    - `dd`：删除当前行(也可以和`number`选项连用)
      - 此时删除的内容会置入vim的缓冲区，可以用粘贴命令`p`再次输出，该操作可以将已删除的文本内容置于光标之后。如果最后一次删除的是一个整行，那么该行将置于当前光标所在行的下一行

- 撤销：

  - 单个撤销：`u` (助记：***u*** ndo)
    - 与`number`选项连用
  - 将所在行恢复至原始状态：`U`

- 替换单个字符：`r`	(按下一次选中当前字符，再次按下其他字符将原字符替换)

- 连续替换多个字符：`R` (修改完成后按`Esc`键退出，未编辑部分不变)

- 替换：`c`  (助记：***c*** hange)

  - 替换单个单词：`cw`   (助记：***c*** hange ***w*** ord)
    - 从光标处开始，光标前面的单词部分不变
  - 替换当前行：`cc`
  - 与移动键的联合使用

- 查找替换：`:s`   (助记：***s*** earch)

  - 一般格式：`:[range]s/{pattern}/{string}/[flags] [count]`

  e.g.
  ```
  :%s/foo/goo/gc
  ```
  上面例子查找字符`foo`并将其替换为`goo`；`%`表示查找范围在整个文件；`/`为分隔符(用其他非空非数字非字母的字符替代也可以)；`g`选项代表一行中的所有(若不加则只会替换一行中的第一个匹配字符串)；`c`选项代表询问，即在每次替换奇拿会询问`replace with {string} (y/n/a/q/l/^E/^Y)?`,按`y`替换，按`l`替换当前匹配项并退出，按`q`或`Esc`退出，按`a`替换所有匹配项，向下滚动屏幕用`ctrl + Y`，向下滚动用`ctrl + E`

  - 正则表达式搜索
  - 区分大小写
  - 查询范围`[range]`:

    - 默认为当前行
    - 范围可以是一行，也可以是两行之间的范围。行说明符之间可用英文`,`分隔`;`字符分割。可以使用绝对行号或特殊符号指定范围
      e.g.
    ```
    :3,10s,foo,goo,g
    ```
    上面例子表示在第3行到第10行查找并替换所有的`foo`为`goo`

    - 字符`.`代表当前行，`$`代表最后一行

## 定位与跳转

- 查看当前文件的总行数：`ctrl + g`
- 回到文档开头：`gg`	 (助记：***gg***  = 重开)
- 跳到文档最下方：`G`	(助记：***G*** ame over)
- 定位并跳转到目标行号：`[行号] + G`	(在输入行号时，命令行内不会有显示)
- 搜索：
  (会进入命令行)
  - 从上到下搜索：`/ <wantFind> <Enter>`
  - 从下到上搜索：`? <wantFind> <Enter>`
  - 要查找同上一次的字符串，只需要按 `n` 键。要向相反方向查找同上一次的字符串，输入 `N` 即可
  - 如果查找已经到达文件末尾，查找会自动从文件头部继续查找
- 配对括号的查找
  - 光标置于目标括号，按下`%`键，光标会跳转到其配对的括号处
  - 适用括号：`()`、`[]`、`{}`
  - <font color=red>ATTENTION</font>:对中文括号不支持！！！



## 复制与粘贴

- 复制光标所在单词：`yaw` (助记：***y*** ank ***a*** ll ***w*** word)
- 复制光标所在行：`yy`
- `y` 与移动键的联合使用
  e.g.   `y4j`代表复制从光标所在行到下面 *4* 行（即总共 *5* 行）的所有内容
- 粘贴：`p`  (助记：***p*** aste)

## 可视模式

按下`v`(***v*** iew)键进入，之后用移动键可以选中内容进行其他操作

## Vim与外部环境的联动

### 在Vim中执行外部命令

```
:!<command> <Enter>
```

### 在Vim中另存文件到外部

```
//另存文件的全部内容
:w <fileName> <Enter>
//另存文件的部分内容
:<topLine>,<endLine> w <fileName> <Enter>
```

### 提取和合并文件

```
:r <fileName>
```

提取进来的文件从光标所在位置处开始置入

## 退出

- 直接退出：`:q`	(助记：***q*** uit)
- 保存：`:w`   (助记：***w*** rite)
- 保存退出：`:wq`   (助记：***w*** rite and ***q*** uit)
